{% extends 'profiles/base.html' %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2 class="text-success mb-1">üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
                <p class="text-muted mb-0">–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, {{ user.get_full_name|default:user.username }}!</p>
            </div>
            
            {% if user.is_staff %}

            {% endif %}
        </div>
        
        {% if not profile_complete %}
            <div class="alert alert-warning alert-dismissible fade show">
                <strong>üìù –í–Ω–∏–º–∞–Ω–∏–µ!</strong> –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –≤–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º.
                <a href="{% url 'profile' %}" class="alert-link">–ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        {% endif %}
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è</h5>
            </div>
            <div class="card-body text-center">
                <!-- –ê–≤–∞—Ç–∞—Ä–∫–∞ –≤ –¥–∞—à–±–æ—Ä–¥–µ -->
                {% if profile.avatar %}
                    <img src="{{ profile.avatar.url }}" alt="–ê–≤–∞—Ç–∞—Ä" class="profile-avatar mb-3">
                {% else %}
                    <div class="profile-avatar-default mb-3">
                        üë§
                    </div>
                {% endif %}
                <p><strong>üé´ –°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–π –±–∏–ª–µ—Ç:</strong> {{ profile.student_id|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</p>
                <p><strong>üéì –§–∞–∫—É–ª—å—Ç–µ—Ç:</strong> {{ profile.get_faculty_display|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</p>
                <p><strong>üìö –ö—É—Ä—Å:</strong> {{ profile.get_course_display|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</p>
                <p><strong>üë• –ì—Ä—É–ø–ø–∞:</strong> {{ profile.group|default:"–ù–µ —É–∫–∞–∑–∞–Ω–∞" }}</p>
                <a href="{% url 'profile' %}" class="btn btn-primary mt-3">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üì∞ –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–∞–π—Ç—ã</h5>
            </div>
            <div class="card-body">
                {% if subscriptions %}
                    <p>–í—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ <strong class="text-success">{{ subscriptions.count }}</strong> —Å–∞–π—Ç(–æ–≤):</p>
                    <div class="list-group">
                        {% for subscription in subscriptions|slice:":5" %}
                            <div class="list-group-item border-0 mb-2">
                                <h6 class="mb-1">üåê {{ subscription.website.name }}</h6>
                                <small class="text-muted">{{ subscription.website.url }}</small>
                            </div>
                        {% endfor %}
                    </div>
                    {% if subscriptions.count > 5 %}
                        <p class="mt-2 text-muted">... –∏ –µ—â–µ {{ subscriptions.count|add:"-5" }}</p>
                    {% endif %}
                {% else %}
                    <p class="text-muted">üì≠ –£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫.</p>
                {% endif %}
                <a href="{% url 'manage_subscriptions' %}" class="btn btn-success mt-3 w-100">üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏</a>
            </div>
        </div>
        
        <!-- –û–∂–∏–¥–∞—é—â–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è -->
        {% if pending_subscriptions %}
        <div class="card mt-3">
            <div class="card-header bg-warning text-white">
                <h5 class="mb-0">‚è≥ –û–∂–∏–¥–∞—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</h5>
            </div>
            <div class="card-body">
                <p>–û–∂–∏–¥–∞—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è <strong class="text-warning">{{ pending_subscriptions.count }}</strong> –ø–æ–¥–ø–∏—Å–æ–∫:</p>
                <div class="list-group">
                    {% for subscription in pending_subscriptions|slice:":3" %}
                        <div class="list-group-item">
                            <h6 class="mb-1">{{ subscription.website.name }}</h6>
                            <small class="text-muted">–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</small>
                        </div>
                    {% endfor %}
                </div>
                {% if pending_subscriptions.count > 3 %}
                    <p class="mt-2 text-muted">... –∏ –µ—â–µ {{ pending_subscriptions.count|add:"-3" }}</p>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}